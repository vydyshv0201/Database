create table main
(
	id_owner_info int,
	id_number_info int,
	id_type int,
	id_service int, 
	id_services_dates int,
	constraint main_key primary key (id_owner_info, id_number_info, id_type, id_service)
);

create table phone_location
(
	id_phone_location int generated by default as identity primary key,
	street varchar(30),
	house int,
	apartment int
);

create table owner_info
(
	id_owner_info int generated by default as identity primary key,
	passport varchar(100) not null,
	owner varchar(60) not null,
	street varchar(30) not null,
	house int not null,
	apartment int
);

create table service_date
(
	id_services_dates int generated by default as identity primary key,
	connection_date date not null,
	shutdown_date date
);

create table number_info
(
	id_number_info int generated by default as identity primary key,
	phone_number varchar(20) not null unique,
	id_phone_location int
);

create table type
(
	id_type int generated by default as identity primary key,
	type varchar(20) not null
);

create table service
(
	id_service int generated by default as identity primary key,
	open_service varchar(20)	
);

ALTER TABLE number_info ADD CONSTRAINT FK_numinphoneloc FOREIGN KEY (id_phone_location)  REFERENCES phone_location (id_phone_location);
ALTER TABLE main ADD CONSTRAINT FK_main_serdate FOREIGN KEY (id_services_dates)  REFERENCES service_date (id_services_dates);
ALTER TABLE main ADD CONSTRAINT FK_main_owner FOREIGN KEY (id_owner_info)  REFERENCES owner_info (id_owner_info);
ALTER TABLE main ADD CONSTRAINT FK_main_num FOREIGN KEY (id_number_info)  REFERENCES number_info (id_number_info);
ALTER TABLE main ADD CONSTRAINT FK_main_type FOREIGN KEY (id_type)  REFERENCES type (id_type);
ALTER TABLE main ADD CONSTRAINT FK_main_serv FOREIGN KEY (id_service)  REFERENCES service (id_service);

ALTER TABLE number_info DROP CONSTRAINT FK_numinphoneloc;
ALTER TABLE main DROP CONSTRAINT FK_main_serdate;
ALTER TABLE main DROP CONSTRAINT FK_main_owner;
ALTER TABLE main DROP CONSTRAINT FK_main_num;
ALTER TABLE main DROP CONSTRAINT FK_main_type;
ALTER TABLE main DROP CONSTRAINT FK_main_serv;


drop table phone_location;
drop table owner_info;
drop table service_date;
drop table type;
drop table number_info;
drop table service;
drop table main;

select * from phone_location;

select * from phone_location pl 
inner join number_info ni on pl.id_phone_location = ni.id_phone_location
inner join owner_info oi on oi.id_owner_info = ni.id_owner_info;

INSERT INTO service values 
        ( 1,
		'Интернет'
        );
		
INSERT INTO service values 
        ( 2,
		 'Межгород'
        );
		
INSERT INTO service values 
        ( 3,
		 'Заказ билетов'
        );
		
INSERT INTO service values 
        ( 4,
		 'Справочная 007'
        );
		
INSERT INTO service values 
        ( 5,
		 'Видеоконференция'
        );
		
INSERT INTO service values 
        ( 6,
		 'Переадресация вызова'
        );
		
INSERT INTO service values 
        ( 7,
		 'Конференц-связь'
        );

		

INSERT INTO type values 
        ( 1,
		 'стационарный'
        );
INSERT INTO type values 
        ( 2,
		 'радиотелефон'
        );
INSERT INTO type values 
        ( 3,
		 'сотовый'
        );		





INSERT INTO phone_location values 
        ( 1,
		 'Первомайская',
		 12,
		 6
        );
		
INSERT INTO phone_location values 
        (2, 
		'A4д. Дербыши, ул. Новая',
		 34
        );
		

INSERT INTO owner_info values 
        ( 1,
		 'Серия 7102 № 234567 выдан ГОМ ГУВД Тюменской области 13.03.2001',
		 'Иванов Илья Семенович',
		 'Первомайская',
		 12,
		 6
        );
	
INSERT INTO service_date (id_services_dates, connection_date) values 
        ( 1,
		 '10-01-2005'
        );
		
INSERT INTO service_date values 
        ( 2,
		 '17-01-2003',
		 '05-07-2005'
        );
		
INSERT INTO service_date (id_services_dates, connection_date) values 
        ( 3,
		 '12-11-2005'
        );		
	
		
INSERT INTO number_info values 
        ( 1,
		 '34-12-55',
		 1
        );
		
INSERT INTO number_info values 
        ( 2,
		 '76-12-88',
		 2
        );		
		
INSERT INTO number_info values 
        ( 3,
		 '91-45-17',
		 null
        );	
		
INSERT INTO main values 
(
	1,
	1, 
	1,
	1, 
	1
);
INSERT INTO main values 
(
	1,
	1, 
	1,
	2, 
	1
);	
INSERT INTO main values 
(
	1,
	1, 
	1,
	3, 
	1
);
INSERT INTO main values 
(
	1,
	1, 
	1,
	4, 
	1
);
INSERT INTO main values 
(
	1,
	2, 
	2,
	2, 
	2
);
INSERT INTO main values 
(
	1,
	2, 
	2,
	5, 
	2
);
INSERT INTO main values 
(
	1,
	3, 
	3,
	6, 
	3
);
INSERT INTO main values 
(
	1,
	3, 
	3,
	7, 
	3
);
INSERT INTO main values 
(
	1,
	3, 
	3,
	1, 
	3
);
	
		
	
		
	
		
INSERT INTO phone_location values 
        ( 3,
		 'Обдорская',
		 3,
		 68
        );	
		
INSERT INTO owner_info values 
        (2,
		 'Серия 7329 № 945671 выдан ГОМ ГУВД Свердловской области 27.07.2005', 
		'Петров Сергей Васильевич',
		 'Обдорская',
		 3,
		 68
        );	
INSERT INTO service_date (id_services_dates, connection_date) values 
        ( 4,
		 '06-04-2020'
        );		
INSERT INTO number_info values 
        ( 4,
		 '32-89-67',
		 3
        );		
INSERT INTO number_info values 
        (5,
		 '8(922)057-82-94',
		 null
        );	
INSERT INTO main values 
(
	2,
	4, 
	1,
	1, 
	4
);	
INSERT INTO main values 
(
	2,
	4, 
	1,
	2, 
	4
);	
INSERT INTO main values 
(
	2,
	5, 
	3,
	1, 
	4
);		
INSERT INTO main values 
(
	2,
	5, 
	3,
	5, 
	4
);	
 		

				
		
		
		
		
		
		
	
		
INSERT INTO owner_info values 
        ( 3,
		 'Серия 7378 № 496816 выдан ГОМ ГУВД Курганской области 02.09.2004', 
		 'Сидоров Николай Артемович',
		 'Ленина',
		 102,
		 5
        );		
INSERT INTO service_date values 
        ( 5,
		 '11-05-2009',
		 '09-08-2016'
        );		
INSERT INTO number_info values 
        (6,
		 '8(996)640-36-91',
		 null
        );	
INSERT INTO main values 
(
	3,
	6, 
	3,
	1, 
	5
);	
INSERT INTO main values 
(
	3,
	6, 
	3,
	6, 
	5
);
		














